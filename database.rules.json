{
  "rules": {
    ".read": false,
    ".write": false,

    "modules": { ".read": "auth != null" },
    "leyenda-etapas": { ".read": "auth != null" },

    "permissions": {
      "$uid": {
        ".read": "$uid === auth.uid || root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'",
        ".write": "root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
      }
    },

    "delegations": {
      "$uid": {
        ".read": "$uid === auth.uid || root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'",
        ".write": "root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
      }
    },

    "roles": {
      ".write": "root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
    },

    "modules_config": {
      ".write": "root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
    },

    "auditLogs": {
      ".read": "root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'",
      ".write": "auth != null"
    },

    "configuracion": {
      ".read": "auth != null",
      ".write": "auth != null"
    },

    "cobranzas": {
      "configuracion": {
        ".read": "auth != null",
        ".write": "root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
      },
      "$uid": {
        ".read": "$uid === auth.uid || root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'",
        ".write": "root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
      }
    },

    "usernames": {
      ".read": true,
      ".write": "root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
    },

    "users": {
      ".read": true,
      ".indexOn": ["email"],
      "$uid": {
        ".read": "auth.uid === $uid || root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'",
        ".write": "auth.uid === $uid || root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'",
        ".indexOn": ["empadronadoId"],

        "modules": {
          ".write": "auth.uid === $uid || root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
        }
      }
    },

    "empadronados": {
      ".read": "auth != null",
      "$empadronadoId": {
        ".read": "auth != null",
        ".write": "data.child('authUid').val() === auth.uid || root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'",
        "dni": {
          ".validate": "!data.exists() || newData.val() === data.val() || root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
        },
        "numeroPadron": {
          ".validate": "!data.exists() || newData.val() === data.val() || root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
        },
        "nombre": {
          ".validate": "!data.exists() || newData.val() === data.val() || root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
        },
        "apellidos": {
          ".validate": "!data.exists() || newData.val() === data.val() || root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
        },
        "manzana": {
          ".validate": "!data.exists() || newData.val() === data.val() || root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
        },
        "lote": {
          ".validate": "!data.exists() || newData.val() === data.val() || root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
        }
      },
      ".indexOn": ["authUid","dni","numeroPadron"]
    },

    "correlativos": {
      ".read": "auth != null",
      ".write": "auth != null"
    },

    "cobranzas_v2": {
      ".read": "auth != null",
      ".write": "auth != null",
      "comprobantes": { 
        ".read": "auth != null",
        ".write": "auth != null" 
      },
      "ingresos": {
        ".read": "auth != null",
        ".write": "auth != null"
      },
      "egresos": {
        ".read": "auth != null",
        ".write": "auth != null"
      }
    },

    "personal-seguridad": { ".write": "auth != null" },

    "eventos": {
      ".read": "auth != null",
      ".write": "auth != null",
      "$eventoId": { 
        ".read": "auth != null", 
        ".write": "auth != null" 
      }
    },

    "inscripcionesEventos": {
      ".read": "auth != null",
      ".write": "auth != null",
      "$inscripcionId": { 
        ".read": "auth != null", 
        ".write": "auth != null" 
      }
    },

    "finanzas": {
      ".read": "auth != null",
      ".write": "auth != null"
    },

    "planilla": {
      ".read": "auth != null",
      ".write": "auth != null"
    },

    "deportes": {
      "canchas": {
        ".read": "auth != null",
        ".write": "auth != null"
      },
      "reservas": {
        ".read": "auth != null",
        ".write": "auth != null",
        ".indexOn": ["canchaId", "estado", "fechaInicio", "dni"]
      },
      "configuracion": {
        ".read": "auth != null",
        ".write": "root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'"
      }
    },

    "acceso": {
      "visitas": {
        ".read": "auth != null",
        ".write": "auth != null",
        ".indexOn": ["estado","patronId","createdAt","dni"]
      },
      "trabajadores": {
        ".read": "auth != null",
        ".write": "auth != null",
        ".indexOn": ["estado","dni","padron"]
      },
      "proveedores": {
        ".read": "auth != null",
        ".write": "auth != null",
        ".indexOn": ["estado","ruc"]
      },
      "maestrosObra": { 
        ".read": "auth != null",
        ".write": "auth != null" 
      },
      "favoritos": { 
        ".read": "auth != null",
        ".write": "auth != null" 
      },
      "listas_trabajadores": {
        ".read": "auth != null",
        ".write": "auth != null",
        ".indexOn": ["empadronadoId","fechaInicio","fechaFin","activa"]
      }
    },

    "seguridad": {
      "porticos": {
        "$porticoId": {
          ".read": "auth != null",
          ".write": "auth != null",
          "pendientes": { 
            ".read": "auth != null",
            ".write": "auth != null" 
          }
        }
      },
      "registros_manuales": { 
        ".read": "auth != null",
        ".write": "auth != null" 
      },
      "historial": {
        ".read": "auth != null",
        ".write": "auth != null",
        ".indexOn": ["tipo", "estado", "createdAt", "autorizacionId"]
      }
    },

    "comunicaciones": {
      "mensajes-masivos": {
        ".read": "auth != null",
        ".write": "root.child('users').child(auth.uid).child('modules').child('comunicaciones').val() === 'admin'",
        "$mensajeId": {
          ".read": "auth != null",
          ".write": "root.child('users').child(auth.uid).child('modules').child('comunicaciones').val() === 'admin'"
        }
      }
    },

    "portal": {
      "visitas": {
        ".read": "auth != null",
        ".write": "auth != null"
      },
      "preguntas-frecuentes": {
        ".read": "auth != null",
        ".write": "root.child('users').child(auth.uid).child('modules').child('portal').val() === 'admin'"
      },
      "categorias-pregunta": {
        ".read": "auth != null",
        ".write": "root.child('users').child(auth.uid).child('modules').child('portal').val() === 'admin'"
      },
      "productos": {
        ".read": "auth != null",
        ".write": "root.child('users').child(auth.uid).child('modules').child('portal').val() === 'admin'"
      },
      "categorias-producto": {
        ".read": "auth != null",
        ".write": "root.child('users').child(auth.uid).child('modules').child('portal').val() === 'admin'"
      },
      "pedidos": {
        ".read": "auth != null",
        ".write": "auth != null"
      },
      "sugerencias": {
        ".read": "auth != null",
        ".write": "auth != null"
      },
      "eventos": {
        ".read": "auth != null",
        ".write": "root.child('users').child(auth.uid).child('modules').child('portal').val() === 'admin'"
      },
      "inscripciones-eventos": {
        ".read": "auth != null",
        ".write": "auth != null"
      }
    },

    "security_questions": {
      ".read": true,
      "$uid": {
        ".read": true,
        ".write": "$uid === auth.uid"
      }
    },

    "password_reset_requests": {
      ".read": "root.child('users').child(auth.uid).child('modules').child('padron').val() === 'admin'",
      ".write": "auth != null"
    }
  }
}
